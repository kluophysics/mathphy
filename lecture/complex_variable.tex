% \part{复变函数论}

\chapter{复变函数论}
\label{chap:complexfunctions}
复变函数论是物理学和工程学广泛使用的强大分析工具，学习掌握这个理论十分必要。
\section{复数和复变函数}
\subsection{复数的定义和基本性质}
\subsubsection{定义}
一元二次方程$a x^2 + b x + c = 0 (a\neq 0, b,c \in \mathbb{R})$的求解大家一定都不陌生。当$\Delta \equiv b^2 - 4 a c \geq 0$时，方程有解，求根公式可得
\begin{equation}
    x = \frac{-b \pm \sqrt{\Delta}}{2a} \textrm{。}
\end{equation}
当$\Delta < 0$时，方程无解。这里的无解其实是指没有实数解。
当我们引入以下这一核心定义后，
\begin{equation}
    \imath ^2 = -1 \quad \textrm{或} \quad \imath = \sqrt{-1} \textrm{。} 
\end{equation}
$\imath$为{\bf 虚数}，将定义域扩展到复数，二次方程就有确定的两个解，当$\Delta < 0$时，方程有两个复数解:
\begin{equation}
    x = \frac{-b \pm \imath \sqrt{-\Delta}}{2a} \textrm{。}
\end{equation}
复数$z$定义为
\begin{equation}
    \label{eq:complex_alg}
    z = x + \imath \; y \textrm{，}
\end{equation}
$x,y \in {\mathbb{R}}$。$x,y$分别为复数$z$的{\bf 实部}(real part) 和{\bf 虚部}(imaginary part)。
上式\eqref{eq:complex_alg}成为复数的代数式。复数域常用$\mathbb{C}$来表示。若将$z$看成是由$x,y$组成的有序对$(x,y)$，记为
\begin{equation}
    z \equiv (x,y)\textrm{，}
\end{equation}
则有$1 = (1,0), \imath = (0, 1)$。如果将$x,y$当做平面上点的坐标，复数$z$就和平面上的点一一对应起来。
形成的平面叫做{\bf 复数平面}，坐标轴成为{\bf 实轴}和{\bf 虚轴}。
\begin{figure}[htb]
    \centering
    \input{tikz/complex_plane.tex}
  \caption{复数的平面表示。} \label{fig:complex_plane}
\end{figure} 
自然我们可以改用极坐标来表示，
\begin{align}
    & \rho = \sqrt{x^2 + y^2}\\
    & \varphi = \arctan y/x
\end{align}
或
\begin{align}
    & x = \rho \cos\varphi \\
    & y = \rho \sin\varphi 
\end{align}
则我们得到复数$z$的三角式
\begin{equation}
    z = \rho (\cos\varphi +  \imath\; \sin\varphi) \textrm{，}
\end{equation}
或指数式
\begin{equation}
    z = \rho e^{\imath \varphi} \textrm{。}
\end{equation}
$\rho = |z|$ 为复数的{\bf 模}(modulus), $\varphi$为复数的{\bf 辐角}(argument)，记作$\Arg z$。
对于任意一个$z=\rho e^{\imath \varphi}$，由于恒等式$e^{\imath 2\pi n} = 1$, $n = 0, \pm 1, \pm 2, \dots, \in \mathbb{Z}$，
可以知道辐角$\Arg z$不能唯一确定，它们之间相差$2\pi$的整数倍，其中满足
\begin{align}
    0 \leq \Arg z < 2\pi \textrm{，}
\end{align}
的辐角为$z$的主辐角，记为$\arg z$。$\arg z$ 为$\Arg z$的主值。
\begin{align}
    \Arg z = \arg z + 2 n \pi \quad (n = 0, \pm 1, \pm 2\dots)\textrm{。}
\end{align}
\begin{examplebox}{求$\sqrt[3]{-\imath}$。}
    首先，我们有恒等式$e^{\imath 2\pi n} = 1$，且
    \begin{align*}
        e^{\imath \frac{\pi}{2}}  = i & \quad  e^{\imath \pi}  =-1 \\
        e^{\imath \frac{3\pi}{2}} = -i & \quad e^{\imath 2\pi} = 1\textrm{。}
    \end{align*}
题目就是要求方程$z^3 =\sqrt[3]{-\imath}$的根。可以得到
    \begin{align*}
        e^{\frac{1}{3}(\imath 2\pi n + \imath \frac{3\pi}{2})} & = (-i)^{\frac{1}{3}} \\
        e^{(\imath \frac{2}{3}\pi n + \imath \frac{\pi}{2})}   & =  (-i)^{\frac{1}{3}} \\
    \end{align*}
得到的解分三种情况
    \begin{align*}
        z_1 &=e^{\imath \frac{\pi}{2}} = \imath , n = 3k \\
        z_2 &=e^{\imath \frac{7\pi}{6}} = -\frac{\sqrt{3}}{2} - \frac{\imath}{2} , n = 3k +1 \\
        z_3 &=e^{\imath \frac{11\pi}{6}} = -\frac{\sqrt{3}}{2} + \frac{\imath}{2} , n = 3k +1 
    \end{align*}
它们在复平面上的分布如下图所示，它们之间的夹角为$120^\circ$，模为单位长度$1$。
    % \begin{figure}
        \centering 
        \input{tikz/rotate.tex}
    % \end{figure}
\end{examplebox}

\subsubsection{基本性质}
我们可以利用有序实数对的方式对复数进行基本运算: 加减乘除运算。{\bf 加法}运算可以定义为
\begin{align}
    z_1 + z_2 = (x_1, y_1) + (x_2, y_2) = (x_1 + x_2, y_1 + y_2) \textrm{。}
\end{align}
{\bf 乘法}运算定义为
\begin{align}
    z_1 \cdot z_2 = (x_1, y_1) \cdot (x_2, y_2) = (x_1 x_2 - y_1 y_2, x_1 y_2 + x_2 y_1) \textrm{。}
\end{align}
显然加法和乘法满足{\bf 交换律}和{\bf 结合律}，以后乘法运算符号$\cdot$均省略。
同实数一样，根据以上定义我们可以得到复数域中的一些特殊元素。对于任意复数$z$,复数域中存在元素$e$满足以下性质
\begin{align}
    & e + z = z + e = z \textrm{，}\\ 
    & e \cdot z = z \cdot e = z \textrm{，} 
\end{align}
可以得到对应的分别为
\begin{align}
    (0, 0) &= 0\\
    (1, 0) &= 1 \textrm{，}
\end{align}
通过元素$(0,0)$,我们可以定义$-z$使得 $-z + z = 0$。 于是有，$- z = (-x, -y)$。于是我们定义
{\bf 减法}运算为 
\begin{align}
    z_1 - z_2 \equiv z_1 + (-z_2) = (x_1 - x_2, y_1 - y_2) \textrm{，}
\end{align}
通过元素$(1,0)$，我们定义$z^{-1}$使得
$z^{-1} \cdot z = 1$，于是有 $z^{-1} =e^{-\imath \varphi}/\rho  $。
或$z^{-1} = (\frac{x}{x^2 + y^2}, -\frac{y}{x^2 + y^2})$。{\bf 除法}运算定义为
\begin{align}
    z_1 / z_2 \equiv z_1 \cdot z_2^{-1} = \frac{x_1 x_2 - y_1 y_2} {x_2^2  +  y_2^2 }  + \imath \frac{y_1 x_2 - x_1 y_2} {x_2^2  +  y_2^2 } \textrm{。} 
\end{align}
注意往往乘除写成极坐标表达更简洁:
\begin{align}
    z_1 z_2 = \rho_1 e^{\imath \varphi_1 } \rho_2 e^{\imath \varphi_2 } = \rho_1 \rho_2 e^{\imath (\varphi_1 + \varphi_2)}
\end{align}

此外，复数还有一种运算较为特殊，称为{\bf 共轭}(complex conjugation)运算。共轭运算表示为
\begin{align}
    z^{*} \equiv (x, -y) = x - \imath y \textrm{。}
\end{align}
为了得到$z$的模，我们可以利用共轭运算，$|z| = \sqrt{zz^{*}}$。注意区分$|z|^2$和$z^2$的不同。

部分复数运算可以映射到复平面上。如共轭运算可以理解为对$z$以实轴为对称轴的镜面对称。对任意的$z_1,z_2$，它们的加减
同向量的加减完全等价，由三角形的三边关系可得
\begin{equation}
    \left| |z|- |z'| \right| \leq |z \pm z'| \leq |z| + |z'| \textrm{。}
\end{equation}
很显然，$z+z^{*} = 2 \Re z$， $z-z^{*} = 2\imath \Im z$。
\begin{figure}
% \begin{minipage}{0.5\textwidth}
% \begin{figure}[htb]
    \centering
    \input{tikz/zminus.tex}
%   \caption{共轭的几何表示。} \label{fig:zminus}
% \end{figure} 
% \end{minipage}
\quad 
% \begin{minipage}{0.5\textwidth}
    % \begin{figure}[htb]
        % \centering
        \input{tikz/zaddition.tex}
    %   \caption{共轭的几何表示。} \label{fig:zminus}
    % \end{figure} 
% \end{minipage}
        \caption{左图:共轭$z^{*}$与$z$的关系; 右图:$z_1, z_2$的加减关系。}
    \end{figure}
\begin{examplebox}{讨论$\Re \frac{1}{z} = 2$在复平面上的意义。}
    \begin{align*}
        \Re \frac{1}{z} &= 2\\
        \Re \frac{1}{x+\imath y} &  = 2 \\
        \frac{x}{x^2 +y^2} & = 2
    \end{align*}
    因此，我们得到方程
    \begin{equation*}
        (x-\frac{1}{4})^2 + y^2 = \left( \frac{1}{4}\right)^2\textrm{，}
    \end{equation*}
    它表示以$(\frac{1}{4},0)$为圆心，$\frac{1}{4}$为半径的圆上各点集合。
    \end{examplebox}
        
    % \subsection{复数运算的几何表示}
\subsubsection{三角函数和双曲函数}
通过复数的引入，我们很容易定义三角函数(trigonometric functions)，如正余弦函数(sine/cosine function)可以表示为互为共轭的指数函数的和差
\begin{align}
    \cos \varphi = \frac{e^{\imath \varphi} + e^{ -\imath \varphi} }{2}
    \\
    \sin \varphi = \frac{e^{\imath \varphi} - e^{ -\imath \varphi} }{2\imath}
\end{align}
而双曲函数(hyperbolic functions)中正余函数(hyperbolic sine/cosine function)则表达为
\begin{align}
    \cosh \varphi &= \frac{e^{\varphi} + e^{ - \varphi} }{2}
    \\
    \sinh \varphi &= \frac{e^{\varphi} - e^{ - \varphi} }{2} \textrm{。}
\end{align}
比较两组方程可以得到
\begin{align}
    \cosh iz &= \cos z
    \\
    \sinh iz &= i \sin z\textrm{。}
\end{align}
我们可以用两种方式表示$\exp(\imath n \varphi)$，于是有
\begin{align}
    \cos n \varphi + \imath \sin n\varphi = (\cos \varphi + i \sin \varphi)^n  \textrm{。}
\end{align}
于是可以验证
\begin{align}
    \sin(2\varphi) = 2\sin\varphi \cos\varphi\textrm{，} \quad \cos (2\varphi) = \cos^2\varphi - \sin^2\varphi \textrm{。}
\end{align}
利用$\sin \theta = \sqrt{1 - \sin ^2 \theta }$(取正)，可以得到
\begin{equation}
  e^{\imath \theta} = \sqrt{ 1 - \sin ^2 \theta } + \imath \sin \theta \textrm{。}  
\end{equation} 
令$\sin \theta = z$，$\theta = \sin^{-1} (z)$，对两边同时求对数得到
\begin{equation}
    \sin^{-1} (z) = -\imath \ln \left[ \imath z + \sqrt{1-z^2} \right]
\end{equation}
类似的，
\begin{equation}
    \begin{array}{cc}
    \sin ^{-1}(z)=-i \ln \left[i z+\sqrt{1-z^2}\right], \quad \tan ^{-1}(z)=\frac{i}{2}[\ln (1-i z)-\ln (1+i z)], \\
    \sinh ^{-1}(z)=\ln \left[z+\sqrt{1+z^2}\right], \quad \tanh ^{-1}(z)=\frac{1}{2}[\ln (1+z)-\ln (1-z)] .
    \end{array}
\end{equation}

\begin{examplebox}{证明
    \begin{equation*}\tanh \frac{z}{2}=\frac{\sinh x+i \sin y}{\cosh x+\cos y} \textrm{。}  
    \end{equation*}
}
根据双曲正切函数的定义
\begin{align*}
    \tanh \frac{z}{2} &= \frac{\sinh \frac{z}{2} }{ \cosh \frac{z}{2}}
    \\
    &= \frac{e^{\frac{z}{2}} - e^{-\frac{z}{2}}}{e^{\frac{z}{2}} + e^{-\frac{z}{2}}}
    \\
    &= \frac{e^{z} - 1}{e^{z} + 1} 
    \\
    &= \frac{e^{x+\imath y } -1 } { e^{x + \imath y } + 1}
    \\
    &=\frac{e^{\imath y } -e^{-x} } { e^{\imath y } + e^{-x}}
\end{align*}   
分子分母同乘以分母的复共轭可得
\begin{align*}
    &=\frac{e^{\imath y } -e^{-x} } { e^{\imath y } + e^{-x}} \frac{e^{-\imath y } + e^{-x}} { e^{-\imath y } + e^{-x}}
    \\
    &=\frac{-1+e^{-2x} + 2 \imath \sin y e^{-x}}{1+ e^{-2x} + 2 \cos y e^{-x} }
    \\
    &= \frac{\sinh x + \imath \sin y} {\cosh x + \cos y} \textrm{。}  
\end{align*}
证毕。
\end{examplebox}

% \subsubsection{}
\subsection{复变函数}
\label{sub:complexfunctions}

\subsubsection{复变函数的定义}
\label{subsub:cmplx_func_def}

存在复数平面的点集$Z$，每一点$z\in Z$有一个或多个复数值$w$与之对应，则称$w$为$z$的函数--复变函数。$z$称为$w$的宗量，定义域为$Z$，记作
\begin{equation}
    w = w(z)\textrm{，} z\in Z \textrm{。}
\end{equation}
任意一个复变函数$w(z)$，$z=x + \imath y$，我们可以写称实部和虚部的组合，
\begin{align}
    w(z) = u(x,y) +\imath \; v(x,y) \textrm{，}
\end{align}
其中$u(x,y), v(x,y)$为纯实函数。它们可以类似的写成
\begin{align}
    \Re w(z) = u(x,y)\textrm{，} \quad \Im w(z) = v(x,y) \textrm{，}
\end{align}
$w(z)$的复共轭为$u(x,y) - \imath \; v(x,y)$。取决于$w(z)$，二者可能相等也可能不等。

这里我们列举一些常见复变函数。
\begin{itemize}
    \item 多项式:
        \begin{equation}
            a_0 + a_1 z + a_2 z^2 + \cdots + a_n z^n \textrm{，} \quad n\in \mathbb{Z}^+ \textrm{，}
        \end{equation}
    \item 有理分式:       
         \begin{equation}
        \frac{a_0 + a_1 z + a_2 z^2 + \cdots + a_n z^n}{{b_0 + b_1 z + b_2 z^2 + \cdots + b_m z^m}} \textrm{，} \quad  n,m\in \mathbb{Z}^+ \textrm{，}
        \end{equation}
    \item 根式:
        \begin{equation}
            (z-a)^{m/n} \textrm{，} \quad  n,m\in \mathbb{Z}^+ \textrm{，}
        \end{equation}
    \item 正余弦，正余切函数 
        \begin{equation}
            \sin z , \cos z , \tan z, \cot z \textrm{，}
        \end{equation}
    \item 双曲正余弦， 双曲正余切函数
        \begin{equation}
            \sinh z , \cosh z , \tanh z, \coth z \textrm{，}
        \end{equation}
    \item 对数、指数
        \begin{equation}
            \ln z = \ln |z| + \imath \Arg z, \quad z^s = e^{s\ln z} \textrm{。}
        \end{equation}
\end{itemize}
以上所有出现的常数均为复数。

\begin{examplebox}{验证\begin{equation*}
    |\sin z|=\frac{1}{2} \sqrt{\left(e^{2 y}+e^{-2 y}\right)+2\left(\sin ^2 x-\cos ^2 x\right)} .
    \end{equation*}
    }
    由正弦函数定义得
    \begin{align*}
        \sin z &= \frac{e^{iz} - e^{-iz}}{2i} 
        \\ 
        & = \frac{e^{ix - y} - e^{-ix + y}}{2i}
        \\
        & = \frac{1}{2i}\left( e^{-y} (\cos x + i \sin x ) - e^{y} (\cos x - i \sin x ) \right) 
        \\
        & = \frac{1}{2i} \left( \cos x (e^{-y} - e^{y}) + i \sin x (e^{-y} + e^{y}) \right)
    \end{align*}
    取模后可得，
    \begin{align*}
        |\sin z | &= \frac{1}{2}\sqrt{ \cos^2x (e^{2y} + e^{-2y} -2) + \sin^2 x (e^{2y} + e^{-2y} +2) }
        \\
        &=\frac{1}{2}\sqrt{\left(e^{2 y}+e^{-2 y}\right)+2\left(\sin ^2 x-\cos ^2 x\right)}
    \end{align*}
    可见，与实函数不同的是，$|\sin z|$的取值完全可以大于$1$。
\end{examplebox}

复数
\begin{figure}
    \centering

    \input{tikz/branch_cut.tex}

\end{figure}
\section{解析函数}


