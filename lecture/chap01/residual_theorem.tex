\subsection{留数定理}
\label{subsec:residual_theorem}
柯西定理指出，若被积函数$f(z)$在回路$\ell$所围区域是解析的，则回路积分$\oint_\ell f(z) dz$为零。下面讨论所围区域包含奇点的情况。
假设一个含有$m$阶极点$z=z_0$的函数，它可以展开为洛朗级数
\[
  f(z) = \sum_{k = -m} ^{\infty} a_k (z - z_0)^k  
\]
取圆环内包含$z_0$的闭合回路，由柯西定理可知，回路积分$\oint_\ell f(z) dz = \oint_C f(z) dz$, 将洛朗展开带入逐项积分，可得
\[
\oint_\ell f(z) dz = \sum_{k = -m} ^{\infty} \oint_C  (z - z_0)^k dz,
\]
由前面例题可知，只有$a_{-1}$项不为零，其他项为零。而$a_{-1}$项的积分为$2\pi\imath$。因此，我们得到
\begin{equation}
    \oint_\ell f(z) dz = 2\pi \imath a_{-1} \textrm{。}
\end{equation}
又因为$a_{-1}$为函数$f(z)$在$z=z_0$处的留数,记为$Res f(z_0)$。于是有
\begin{equation}
    \oint_\ell f(z) dz = 2\pi \imath Res f(z_0) \textrm{。}
\end{equation}
扩展到多个奇点的情况，不难得到
\begin{equation}
    \oint_\ell f(z) dz = 2\pi \imath \sum_{j=1}^{n} Res f(z_j) \textrm{。}
\end{equation}
上式为\textbf{留数定理}的数学表达式，即回路积分可以写成被积函数在回路所围区域上各个奇点的留数之和。

下面介绍一下计算留数的一种方法。
通常，我们并不总是要将一个函数展开为洛朗级数来找出$a_{-1}$的值。如果$f(z)$有
$n$阶极点$z_0$，那么有
\begin{equation}
    \left(z-z_0\right)^n f(z)=a_{-n}+\cdots+a_{-1}\left(z-z_0\right)^{n-1}+a_0\left(z-z_0\right)^n+\cdots .
\end{equation}
不断求导后可以验证
\begin{equation}
    a_{-1}=\frac{1}{(n-1) !} \lim _{z \to z_0}\left[\frac{d^{n-1}}{d z^{n-1}}\left(\left(z-z_0\right)^n f(z)\right)\right]
\end{equation}
若 $f(z)$ 可以表示为 $P(z) / Q(z)$ 的特殊形式, 其中 $P(z)$ 和 $Q(z)$ 都在 $z_0$ 点 解析, $z_0$ 是 $Q(z)$ 的一阶零点. $P\left(z_0\right) \neq 0$, 从而 $z_0$ 是 $f(z)$ 的一阶极点, 则
\begin{equation}
    Res f\left(z_0\right)=\lim _{z \to z_0}\left(z-z_0\right) \frac{P(z)}{Q(z)}=\frac{P\left(z_0\right)}{Q^{\prime}\left(z_0\right)} .
\end{equation}
上式最后一步应用了罗毕达法则.
下面给出一些计算留数的例子。
\begin{examplebox}{计算留数。}
    
    \begin{enumerate}
        \item $\frac{1}{\sin z}$在$z=0$处的留数为$\lim_{z\to 0} \frac{z}{\sin{z}} = 1$。
        \item $\frac{\ln{z}}{z^2 + 4}$在$z=2e^{\imath \pi}$处的留数为$\lim_{z\to 2e^{\imath \pi}} \frac{(z-2e^{\imath \pi})\ln{z} }{z^2 + 4} = 
        \frac{\ln 2 + \imath \pi}{4\imath} = \frac{\pi}{4} - \frac{\imath\ln{2}}{4}\textrm{。}$
        \item $f(z) = \frac{\cot{\pi z}}{z(z+2)}$在$z=0$处的留数。\\
            \[
              f(z) = \frac{1}{z} \left[\frac{1}{\pi z} + O(z) \right]\frac{1}{2} \left[1 - \frac{z}{2} + O(z^2)\right]  
            \]
            可以得到该函数的留数为$-1/(4\pi)$。
        \item $f(z) = \frac{1}{z^n - 1}$在$z=1$处的留数可通过如下方法。可知
        \[
            f(z)=\frac{1}{z^n-1}=\frac{1}{(z-1)\left(z^{n-1}+z^{n-2}+\cdots+z+1\right)},
        \]
        因此，有
        \[
            \begin{aligned}
                \operatorname{Res} f(1) & =\lim _{z \to 1}\left[(z-1) \frac{1}{(z-1)\left(z^{n-1}+z^{n-2}+\cdots+z+1\right)}\right] \\
                & =\lim _{z \to 1} \frac{1}{z^{n-1}+z^{n-2}+\cdots+z+1}=\frac{1}{n} \textrm{。}
            \end{aligned}
        \]
        或者用 $$
        \lim _{z \to 1}\left[\frac{1}{\left(z^n-1\right)^{\prime}}\right]=\lim _{z \to 1} \frac{1}{n z^{n-1}}=\frac{1}{n} \textrm{。}
        $$ 因此，此函数在$z=1$处的留数为$1/n$。
    \end{enumerate}
\end{examplebox}


% \subsection{留数定理的应用}
% \label{subsec:residual_theorem_applications}